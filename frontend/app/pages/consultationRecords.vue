<script setup lang="ts">
import { ref, computed } from "vue";

const goBack = () => {
  window.history.back();
};

const downloadReport = () => {
  console.log("AI ë¦¬í¬íŠ¸ ì—´ëŒ(PDF) ë‹¤ìš´ë¡œë“œ");
};

// ë³µì•½ ì´í–‰ë¥  (ë™ì ìœ¼ë¡œ ë³€ê²½ ê°€ëŠ¥)
const adherenceRate = ref(80);

// ì›í˜• í”„ë¡œê·¸ë ˆìŠ¤ ê³„ì‚°
const progressCalculation = computed(() => {
  const radius = 40;
  const circumference = 2 * Math.PI * radius;
  const progress = (adherenceRate.value / 100) * circumference;
  const remaining = circumference - progress;

  return {
    circumference,
    strokeDasharray: circumference,
    strokeDashoffset: remaining,
  };
});

// ë³µì•½ ë°ì´í„°
const medicationData = [
  {
    id: 1,
    time: "ì•„ì¹¨ 8ì‹œ",
    medications: [
      { name: "ê´€ë¦¬ ì•½í’ˆ", description: "ê³ í˜ˆì••ì•½ 5mg + í˜ˆì••ê´€ë¦¬ì•½ 500mg" },
      {
        name: "í˜ˆì•• ë° ì‹¬ì¥ ë³´ê±´",
        description: "í˜ˆì•• ë‚®ì€ ì¤‘ : í•˜ë£¨ ì¤‘ í˜ˆì•• ìƒìŠ¹ 70-80",
      },
      {
        name: "ê°€ì´ë“œ",
        description:
          "â˜… í˜ˆì•• ë‚®ì¶”ë ¤ë©´ ê±·ê¸°ìš´ë™ì„ ì¶”ì²œ, ë° ë‚®ì  ë³´í˜¸ì§„ì‹  ì£¼ì˜ ìƒí™œ ê´€ì°°ë¬¼ì´ í˜ˆì••ì„ ê°œë°© : ë†’ëŠ” ë¶€, ì‹¶ê¸° ë‚®ì¶˜ë‹¤ ê·¸ ì¹¼ë ˆê³ ë¦¬ ë°©ì–´ ë³´ê´€ì¡°ì „ì¤‘ì¹˜ ë‚®ì¶°ì§€ëŠ” ìˆ˜ìš©ì•¡ì„ ì˜í•´ ë‚¨ê¸°ì¢‹ë‹¤.",
      },
    ],
  },
  {
    id: 2,
    time: "ì•„ì¹¨ ë°˜ì‘ 2",
    description: "ì—†ìŒì—†ìŒ",
  },
  {
    id: 3,
    time: "ì•„ì¹¨ ë°˜ì‘ 3",
    medications: [
      { name: "ê´€ë¦¬ ì•½í’ˆ", description: "ê´€ë¦¬ 500mg" },
      {
        name: "í˜ˆì•• ë° ì‹¬ì¥ ë³´ê±´",
        description: "CPUê°€ ì–‘ì´ ë¶€ìœ„ = ê´€ì°° ê¸°ì¤€ ì¦ìƒ ìœ ì§€",
      },
      {
        name: "ê°€ì´ë“œ",
        description:
          "â˜… ê´€ë¦¬ë°©ë²•ì´ë‚˜ í˜¸ì‹¤ìš´ë™ì„ ê°€ë“¤ì§„ ë“±ëŒì„  ì•½ë¬´ìˆê³ ì¦ : í—ˆê°€, ë°°ì–‘ë ¥ì¹¨ ì¦ë³´, ëŒê°€ í˜ˆì••ì¥ ë§ˆì‹œì .",
      },
    ],
  },
  {
    id: 4,
    time: "ì•„ì¹¨ ë°˜ì‘ 4",
    description: "ì—†ìŒ",
  },
];

// ì˜ì•½ì‚¬ ì •ë³´
const pharmacistInfo = {
  name: "ê¹€ì§€ìœ¤",
  title: "ì•½ì‚¬, ë³µì•½",
  license: "ë©´í—ˆë²ˆí˜¸",
  number: "101-1234-56789",
  phone: "010-1234-5678",
  location: "ì„œìš¸íŠ¹ë³„ì‹œ",
  history: [
    "ì‹ ì´Œì•½ ì•½êµ­ ê·¼ë¬´ (2025.05~í˜„ì¬)",
    "ì¢…í•©ë‚´ ë³‘ì› ê·¼ë¬´ (2021.05~2025.04)]",
  ],
};
</script>

<template>
  <!-- ë¦¬í¬íŠ¸ í˜ì´ì§€ ì „ì²´ wrap -->
  <div class="min-h-screen w-full bg-gray-50">
    <!-- í—¤ë” -->
    <div
      class="relative flex items-center px-6 py-6 bg-white border-b border-gray-100"
    >
      <button @click="goBack" class="mr-4 p-2">
        <svg
          class="w-6 h-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M15 19l-7-7 7-7"
          />
        </svg>
      </button>
      <p
        class="absolute left-1/2 transform -translate-x-1/2 text-lg font-medium text-black"
      >
        2025ë…„ 5ì›” 15ì¼
      </p>
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <div class="px-4 py-6 pb-28">
      <!-- ê¸°ì € ì§ˆí™˜ ì„¹ì…˜ -->
      <div class="mb-6">
        <div class="flex items-center mb-4">
          <div
            class="w-6 h-6 bg-blue-500 rounded text-white flex items-center justify-center text-sm font-bold mr-3"
          >
            1
          </div>
          <h2 class="text-lg font-semibold text-gray-900">ê¸°ì € ì§ˆí™˜</h2>
        </div>
        <div class="bg-white rounded-2xl p-4 space-y-3">
          <div class="flex space-x-2">
            <span
              class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm"
              >ê³ í˜ˆì••</span
            >
            <span
              class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm"
              >ë‹¹ë‡¨</span
            >
          </div>
        </div>
      </div>

      <!-- ì´ìƒ ë°˜ì‘ ì„¹ì…˜ -->
      <div class="mb-6">
        <div class="flex items-center mb-4">
          <div
            class="w-6 h-6 bg-blue-500 rounded text-white flex items-center justify-center text-sm font-bold mr-3"
          >
            2
          </div>
          <h2 class="text-lg font-semibold text-gray-900">ì´ìƒ ë°˜ì‘</h2>
        </div>

        <!-- ë³µì•½ ê¸°ë¡ë“¤ -->
        <div class="space-y-4">
          <div
            v-for="record in medicationData"
            :key="record.id"
            class="bg-white rounded-2xl p-4"
          >
            <div class="flex items-center mb-3">
              <span class="text-2xl mr-3">ğŸ’Š</span>
              <h3 class="font-semibold text-gray-900">{{ record.time }}</h3>
            </div>

            <!-- ë³µì•½ ì •ë³´ê°€ ìˆëŠ” ê²½ìš° -->
            <div v-if="record.medications" class="space-y-3">
              <div
                v-for="med in record.medications"
                :key="med.name"
                class="border-l-2 border-gray-200 pl-3"
              >
                <div class="flex items-center mb-1">
                  <span class="w-2 h-2 bg-gray-400 rounded-full mr-2"></span>
                  <span class="text-sm font-medium text-gray-700">{{
                    med.name
                  }}</span>
                </div>
                <p class="text-sm text-gray-600 ml-4">{{ med.description }}</p>
              </div>
            </div>

            <!-- ë³µì•½ ì •ë³´ê°€ ì—†ëŠ” ê²½ìš° -->
            <div v-else class="text-sm text-gray-500">
              {{ record.description }}
            </div>
          </div>
        </div>
      </div>

      <!-- ë³µì•½ ì˜ì‚¬ ì¢…í•© ì˜ê²¬ ì„¹ì…˜ -->
      <div class="mb-6">
        <div class="flex items-center mb-4">
          <div
            class="w-6 h-6 bg-blue-500 rounded text-white flex items-center justify-center text-sm font-bold mr-3"
          >
            3
          </div>
          <h2 class="text-lg font-semibold text-gray-900">
            ë³µì•½ ì˜ì‚¬ ì¢…í•© ì˜ê²¬
          </h2>
        </div>

        <div class="bg-white rounded-2xl p-4">
          <div class="text-sm text-gray-600 mb-4">ë³µì•½ ì´í–‰ë¥ </div>

          <!-- ê·¸ë˜í”„ì™€ ì„¤ëª…ì„ ë‚˜ë€íˆ ë°°ì¹˜ -->
          <div class="flex items-center space-x-6 mb-4">
            <!-- ì›í˜• í”„ë¡œê·¸ë ˆìŠ¤ ë°” -->
            <div class="relative w-20 h-20 flex-shrink-0">
              <svg class="w-20 h-20 transform -rotate-90" viewBox="0 0 100 100">
                <!-- ë°°ê²½ ì› -->
                <circle
                  cx="50"
                  cy="50"
                  r="40"
                  stroke="#e5e7eb"
                  stroke-width="8"
                  fill="none"
                />
                <!-- ì§„í–‰ë¥  ì› (ë™ì ) -->
                <circle
                  cx="50"
                  cy="50"
                  r="40"
                  stroke="#3b82f6"
                  stroke-width="8"
                  fill="none"
                  :stroke-dasharray="progressCalculation.strokeDasharray"
                  :stroke-dashoffset="progressCalculation.strokeDashoffset"
                  stroke-linecap="round"
                  class="transition-all duration-1000 ease-out"
                />
              </svg>
              <!-- ì¤‘ì•™ í¼ì„¼íŠ¸ í‘œì‹œ -->
              <div class="absolute inset-0 flex items-center justify-center">
                <span class="text-lg font-bold text-blue-500"
                  >{{ adherenceRate }}%</span
                >
              </div>
            </div>

            <!-- ì„¤ëª… í…ìŠ¤íŠ¸ -->
            <div class="flex-1">
              <div class="text-lg font-semibold text-gray-900 mb-1">
                {{ adherenceRate }}% í›Œë¥­í•˜ê³ ,
              </div>
              <div class="text-sm text-gray-600">ê±´ì•½í•œ ë‚ ì´ ì•ìœ¼ë¡œ,</div>
              <div class="text-sm text-gray-600">ë”ìš± ëŠ˜ì–´ë‚  ì˜ˆì •</div>
            </div>
          </div>

          <div class="space-y-3">
            <div>
              <div class="text-sm font-medium text-gray-700 mb-1">ëˆ„ë½ì•½í’ˆ</div>
              <div class="text-sm text-gray-600">
                â†’ ë©”ì¸ ì•„ì¹¨ ì•½ê³¼, ë‚ ë§ˆ ì•„ì´í…œì„ ìŠì€ ëˆ„ë½
              </div>
              <div class="text-sm text-gray-600">
                â†’ ì €ë… ì‹œê°„ ìš©ëŸ‰ê³¼, ë‹¨ê¸° ê³„íšì„ ìŠì€ ëˆ„ë½
              </div>
            </div>
            <div>
              <div class="text-sm font-medium text-gray-700 mb-1">
                ë³µì•½ ì‹¤í—ˆ
              </div>
              <div class="text-sm text-gray-600">
                í˜ˆì•½ ì‹œê°„ì— ìš©ëŸ‰, ì‹ ì ‘ì–´ë†“ ê¸° ê¸°íƒ€ ì‹¤í—ˆ
              </div>
              <div class="text-sm text-gray-600">
                â†’ í˜ˆì•½ ì— ì½œ ë”°ëœ¨ê³¼ì˜¤, ì„±ì°¨ ë° ì»¬ë ˆ ë°”ëœ»
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ë³µì•½ ì˜ì‚¬ í”„ë¡œí•„ ì„¹ì…˜ -->
      <div class="mb-6">
        <div class="flex items-center mb-4">
          <div
            class="w-6 h-6 bg-blue-500 rounded text-white flex items-center justify-center text-sm font-bold mr-3"
          >
            4
          </div>
          <h2 class="text-lg font-semibold text-gray-900">ë³µì•½ ì˜ì‚¬ í”„ë¡œí•„</h2>
        </div>

        <div class="bg-white rounded-2xl p-4">
          <div class="flex items-center space-x-4 mb-4">
            <!-- í”„ë¡œí•„ ì´ë¯¸ì§€ -->
            <div class="w-16 h-16 bg-gray-200 rounded-full overflow-hidden">
              <img
                src="https://images.unsplash.com/photo-1559839734-2b71ea197ec2?w=150&h=150&fit=crop&crop=face"
                alt="ì•½ì‚¬ í”„ë¡œí•„"
                class="w-full h-full object-cover"
              />
            </div>
            <div>
              <div class="flex items-center space-x-2 mb-1">
                <h3 class="font-semibold text-gray-900">
                  {{ pharmacistInfo.name }}
                </h3>
                <span class="text-sm text-gray-500">{{
                  pharmacistInfo.title
                }}</span>
                <span
                  class="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded"
                  >ê°„ì¦ëŒ€ìƒ</span
                >
              </div>
              <div class="text-sm text-gray-600">
                <div>
                  {{ pharmacistInfo.license }} : {{ pharmacistInfo.number }}
                </div>
                <div>ì—°ë½ì²˜: {{ pharmacistInfo.phone }}</div>
              </div>
            </div>
          </div>

          <div class="space-y-2 text-sm text-gray-600">
            <div>ìœ„ì¹˜: {{ pharmacistInfo.location }}</div>
            <div>
              ê²½ë ¥
              <ul class="list-disc ml-5">
                <li
                  v-for="(item, index) in pharmacistInfo.history"
                  :key="index"
                >
                  {{ item }}
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- AI ë¦¬í¬íŠ¸ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ -->
      <div class="mt-8">
        <button
          @click="downloadReport"
          class="w-full py-4 bg-blue-500 text-white rounded-2xl font-semibold text-lg hover:bg-blue-600 transition-all"
        >
          AI ë¦¬í¬íŠ¸ ì—´ëŒ(PDF)
        </button>
      </div>
    </div>
  </div>
</template>
